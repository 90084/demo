bso.decodeUtf8=function(t){var e="",r=0,n=0,i=0;for(t.byteLength>=3&&239===t.getUint8(0)&&187===t.getUint8(1)&&191===t.getUint8(2)&&(r=3);r<t.byteLength;)if(n=t.getUint8(r),128>n)e+=String.fromCharCode(n),r++;else if(n>191&&224>n){if(r+1>=t.byteLength)throw"UTF-8 Decode failed. Two byte character was truncated.";i=t.getUint8(r+1),e+=String.fromCharCode((31&n)<<6|63&i),r+=2}else{if(r+2>=t.byteLength)throw"UTF-8 Decode failed. Multi byte character was truncated.";i=t.getUint8(r+1),c3=t.getUint8(r+2),e+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&c3),r+=3}return e};
bso.loadEpisode=function(e){var s=new XMLHttpRequest;s.open("GET","/"+e+".bso",!0),s.responseType="arraybuffer",s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=parseInt(bso.decodeUtf8(new DataView(this.response,0,16)).trim()),s=JSON.parse(bso.decodeUtf8(DataView(this.response,16,e)));s.audioUrl=URL.createObjectURL(new Blob([new DataView(this.response,16+e)],{type:"audio/mpeg"})),bso.runEpisode(s)}},s.send()};

bso.runEpisode=function(o){console.log(o),o.groups.forEach(function(){})};
bso.start=function(){bso.loadEpisode("ep1")};
function transitionend(e){e.target.removeEventListener("transitionend",transitionend),e.target.setAttribute("class","screen")}var activeScreenId="three";bso.screenTransition=function(e,t){var n=document.getElementById(activeScreenId),r=document.getElementById(e);n.addEventListener("transitionend",transitionend),r.setAttribute("class","screen "+t),setTimeout(function(){var e="left"==t?"right":"right"==t?"left":"up"==t?"down":"up";n.setAttribute("class","screen "+e),r.setAttribute("class","screen active")},10)};